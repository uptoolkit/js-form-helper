var S=Object.defineProperty;var m=(i,n,o)=>n in i?S(i,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[n]=o;var a=(i,n,o)=>(m(i,typeof n!="symbol"?n+"":n,o),o);(function(i,n){typeof exports=="object"&&typeof module!="undefined"?n(exports,require("validatorjs")):typeof define=="function"&&define.amd?define(["exports","validatorjs"],n):(i=typeof globalThis!="undefined"?globalThis:i||self,n(i.UpVue={},i.Validator))})(this,function(i,n){"use strict";function o(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var g=o(n);class l{constructor(r={}){this.record(r)}all(){return this.errors}has(r){let t=this.errors.hasOwnProperty(r);return t||(t=Object.keys(this.errors).filter(h=>h.startsWith(`${r}.`)||h.startsWith(`${r}[`)).length>0),t}first(r){return this.get(r)[0]}get(r){return this.errors[r]||[]}any(r=[]){if(r.length===0)return Object.keys(this.errors).length>0;let t={};return r.forEach(e=>t[e]=this.get(e)),t}record(r={}){this.errors=r}clear(r){if(!r){this.errors={};return}let t=Object.assign({},this.errors);Object.keys(t).filter(e=>e===r||e.startsWith(`${r}.`)||e.startsWith(`${r}[`)).forEach(e=>delete t[e]),this.errors=t}}function O(s){return Object.prototype.toString.call(s)==="[object Array]"}function d(s){return s instanceof File||s instanceof FileList}function c(s,r){for(const t in r)s[t]=f(r[t])}function f(s){if(s===null)return null;if(d(s))return s;if(Array.isArray(s)){const r=[];for(const t in s)s.hasOwnProperty(t)&&(r[t]=f(s[t]));return r}if(typeof s=="object"){const r={};for(const t in s)s.hasOwnProperty(t)&&(r[t]=f(s[t]));return r}return s}function w(s,r=new FormData,t=null){if(s===null||s==="undefined"||s.length===0)return r.append(t,s);for(const e in s)s.hasOwnProperty(e)&&F(r,_(t,e),s[e]);return r}function _(s,r){return s?s+"["+r+"]":r}function F(s,r,t){if(t instanceof Date)return s.append(r,t.toISOString());if(t instanceof File)return s.append(r,t,t.name);if(typeof t=="boolean")return s.append(r,t?"1":"0");if(t===null)return s.append(r,"");if(typeof t!="object")return s.append(r,t);w(t,s,r)}const E=["__http","__options","__validateRequestType","clear","data","delete","errors","getError","getErrors","hasError","initial","onFail","only","onSuccess","patch","populate","post","processing","successful","put","reset","submit","withData","withErrors","withOptions"];function y(s){if(E.indexOf(s)!==-1)throw new Error(`Field name ${s} isn't allowed to be used in a Form or Errors instance.`)}class p{constructor(r={},t={}){a(this,"processing");a(this,"successful");a(this,"errors");a(this,"__options");a(this,"initial");this.processing=!1,this.successful=!1,this.withData(r).withOptions(t).withErrors({})}withData(r){O(r)&&(r=r.reduce((t,e)=>(t[e]="",t),{})),this.setInitialValues(r),this.errors=new l,this.processing=!1,this.successful=!1;for(const t in r)y(t),this[t]=r[t];return this}withErrors(r){return this.errors=new l(r),this}withOptions(r){this.__options={resetOnSuccess:!0},r.hasOwnProperty("resetOnSuccess")&&(this.__options.resetOnSuccess=r.resetOnSuccess),r.hasOwnProperty("onSuccess")&&(this.onSuccess=r.onSuccess),r.hasOwnProperty("onFail")&&(this.onFail=r.onFail);const t=typeof window=="undefined"?!1:window.axios;if(this.__http=r.http||t||axios,!this.__http)throw new Error("No http library provided. Either pass an http option, or install axios.");return this}data(){const r={};for(const t in this.initial)r[t]=this[t];return r}only(r){return r.reduce((t,e)=>(t[e]=this[e],t),{})}reset(){c(this,this.initial),this.errors.clear()}setInitialValues(r){this.initial={},c(this.initial,r)}populate(r){return Object.keys(r).forEach(t=>{y(t),this.hasOwnProperty(t)&&c(this,{[t]:r[t]})}),this}clear(){for(const r in this.initial)this[r]="";this.errors.clear()}get(r){return this.submit("get",r)}post(r){return this.submit("post",r)}put(r){return this.submit("put",r)}patch(r){return this.submit("patch",r)}delete(r){return this.submit("delete",r)}submit(r,t){return this.__validateRequestType(r),this.errors.clear(),this.processing=!0,this.successful=!1,new Promise((e,h)=>{this.__http[r](t,this.hasFiles()?w(this.data()):this.data()).then(u=>{this.processing=!1,this.onSuccess(u.data),e(u.data)}).catch(u=>{this.processing=!1,this.onFail(u),h(u)})})}hasFiles(){for(const r in this.initial)if(this.hasFilesDeep(this[r]))return!0;return!1}hasFilesDeep(r){if(r===null)return!1;if(typeof r=="object"){for(const t in r)if(r.hasOwnProperty(t)&&this.hasFilesDeep(r[t]))return!0}if(Array.isArray(r)){for(const t in r)if(r.hasOwnProperty(t))return this.hasFilesDeep(r[t])}return d(r)}onSuccess(r){this.successful=!0,this.__options.resetOnSuccess&&this.reset()}onFail(r){this.successful=!1,r.response&&r.response.data.errors&&this.errors.record(r.response.data.errors)}hasError(r){return this.errors.has(r)}getError(r){return this.errors.first(r)}getErrors(r){return this.errors.get(r)}__validateRequestType(r){const t=["get","delete","head","post","put","patch"];if(t.indexOf(r)===-1)throw new Error(`\`${r}\` is not a valid request type, must be one of: \`${t.join("`, `")}\`.`)}validate(r,t){this.errors.clear(),this.processing=!0,this.successful=!1;let e=t||{},h=new g.default(this.data(),r,e);h.fails()?(this.successful=!1,this.errors.record(h.errors.all())):this.successful=!0}static create(r={}){return new p().withData(r)}}i.Errors=l,i.Form=p,Object.defineProperty(i,"__esModule",{value:!0}),i[Symbol.toStringTag]="Module"});
